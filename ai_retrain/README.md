# 📈 AI 모델 향상 프로그램 (`ai_retrain`)

이 모듈은 프로젝트의 핵심인 **식재료 객체 감지 모델(YOLOv8)**의 성능을 개선하고, 최신 학습 결과를 시스템에 안정적으로 반영하기 위한 자동 재학습 및 배포 파이프라인입니다.

---

## 🗂️ 주요 기능

| 파일/기능 | 역할 | 상세 설명 |
| :--- | :--- | :--- |
| **`train.py`** | **모델 재학습 및 배포 로직** | 준비된 데이터셋을 기반으로 YOLOv8 모델을 학습시키고, 최종 모델을 타임스탬프와 함께 `model/` 디렉토리에 버전별로 저장합니다. |
| **`config.ini` 자동 업데이트** | **최신 모델 반영** | 학습 성공 시, `config.ini` 파일의 `[YOLO_MODEL] - model_path`를 새로운 버전 경로로 즉시 업데이트하여 `main.py` 서버가 최신 모델을 사용하도록 합니다. |
| **안전한 복원 로직** | **시스템 안정성 확보** | `config.ini` 업데이트 중 오류 발생 시, 원본 설정 파일로 자동 복원하여 서버 설정의 손상을 방지합니다. |

---

## ⚙️ 모델 향상을 위한 단계 (재학습)

모델이 새로운 식재료나 다른 사물을 인식하도록 하려면 다음 단계를 거쳐야 합니다.

### 1. 데이터셋 준비 및 구조 설정

재학습을 위해서는 **YOLOv8 형식**의 데이터셋이 필요합니다. 표준적인 YOLO 데이터 구조에 맞춰 데이터를 배치해야 합니다.

| 경로 | 내용 | 역할 |
| :--- | :--- | :--- |
| `[PROJECT_ROOT]/datasets/` | **데이터셋 루트 디렉토리** | 모든 학습 데이터(이미지, 라벨)가 위치하는 곳. |
| `[PROJECT_ROOT]/datasets/data.yaml` | **데이터 정의 파일** | **학습에 필요한 경로**(`train`, `val`, `test` 이미지 경로)와 **모델이 인식할 클래스 이름 및 개수**를 정의합니다. |
| `[PROJECT_ROOT]/datasets/images/train/` | 학습용 이미지 파일 (`.jpg`, `.png`) | 모델이 학습할 원본 이미지를 포함합니다. |
| `[PROJECT_ROOT]/datasets/labels/train/` | 학습용 주석 파일 (`.txt`) | 각 이미지에 해당하는 식재료의 바운딩 박스 위치와 클래스 인덱스를 포함합니다. |

**`data.yaml` 예시:**

```yaml
# 클래스 개수
nc: 5
# 클래스 이름 목록
names: ['apple', 'banana', 'carrot', 'potato', 'tomato']
# 이미지 경로 정의
train: ./datasets/images/train
val: ./datasets/images/val
````

### 2\. 재학습 실행

데이터셋 준비가 완료되면 `train.py` 스크립트를 실행하여 모델 학습을 시작합니다. **`train.py`는 `datasets/data.yaml`을 자동으로 참조하여 학습을 시작합니다.**

```bash
# 프로젝트 루트 디렉토리에서 실행
python ai_retrain/train.py
```

**⚠️ 중요:** `train.py`는 `config.ini`의 `[TRAINING_SETTINGS]`에 정의된 `epochs`, `img_size` 등의 하이퍼파라미터를 사용하여 학습을 진행합니다.

```